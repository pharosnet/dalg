// DO NOT EDIT THIS FILE, IT IS GENERATED BY DALC
package  {{ .Package }}

import (
    "github.com/pharosnet/dalc/v2"
    {{ range $key, $value := .Imports }}
        "{{ $key }}"
    {{ end }}
)

// ************* {{ .RawName }} *************
const {{ .LowName }}SQL = "{{ .QuerySQL }}"

type {{ .Name }}Request struct { {{ range $key, $field := .ResultFields}}
    {{ $field.Name }} {{ $field.Type }}{{ end }}{{ range $key, $field := .RequestFields}}
    {{ $field.Name }} {{ $field.Type }}{{ end }}
}

func {{ .Name }}(ctx dalc.PreparedContext, request *{{ .Name }}Request) (affected int64, err error) {

    querySQL := {{ .LowName }}SQL
    args := dalc.NewArgs() {{ range $key, $field := .ResultFields}}
    args.Arg(request.{{ $field.Name }}){{ end }}{{ range $key, $field := .RequestFields}}
    {{ if eq $field.Replaced true }}
        querySQL = dalc.ReplaceSQL(querySQL, "{{$field.ReplaceKey}}", dalc.NewTupleArgs(request.{{$field.Name}}))
    {{ else }}args.Arg(request.{{ $field.Name }}){{ end }}{{ end }}

    affected, err = dalc.Execute(ctx, querySQL, args)

    return
}